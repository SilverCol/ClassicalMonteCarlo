\documentclass[a4paper]{article}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
%\usepackage[margin=2cm, bottom=3cm, foot=1.5cm]{geometry}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{subcaption}
\usepackage{hyperref}

\newcommand{\tht}{\theta}
\newcommand{\Tht}{\Theta}
\newcommand{\dlt}{\delta}
\newcommand{\eps}{\epsilon}
\newcommand{\thalf}{\frac{3}{2}}
\newcommand{\ddx}[1]{\frac{d^2#1}{dx^2}}
\newcommand{\ddr}[2]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\mddr}[3]{\frac{\partial^2#1}{\partial#2\partial#3}}

\newcommand{\der}[2]{\frac{d#1}{d#2}}
\newcommand{\pder}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\forth}{\frac{1}{4}}
\newcommand{\q}{\underline{q}}
\newcommand{\p}{\underline{p}}
\newcommand{\x}{\underline{x}}
\newcommand{\liu}{\hat{\mathcal{L}}}
\newcommand{\bigO}[1]{\mathcal{O}\left( #1 \right)}
\newcommand{\pauli}{\mathbf{\sigma}}
\newcommand{\bra}[1]{\langle#1|}
\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\id}[1]{\mathbf{1}_{2^{#1}}}
\newcommand{\tinv}{\frac{1}{\tau}}
\newcommand{\s}{\sigma}
\newcommand{\us}{\underline{\s}}
\newcommand{\expected}[1]{\langle #1 \rangle}
\newcommand{\D}{\Delta}

\begin{document}

    \title{\sc\large Višje računske metode\\
		\bigskip
		\bf\Large Klasični Monte-Carlo}
	\author{Mitja Vodnik, 28182041}
	\date{\today}
	\maketitle

    S pomočjo Metropolisovega algoritma bomo raziskali ravnovesna termalna stanja klasičnih Isingovih in Heisenbergovih
    spinov.
    Konkretno si želimo računati pričakovane vrednosti opazljivk $a(\x)$ v visokodimenzionalnem faznem prostoru
    $\x \in \mathcal{R}^N, N \gg 1$, kjer poznamo verjetnostno porazdelitev $w(\x), d\mu(\x) = w(\x)d^N\x$.
    Z Metropolisovim algoritmom pridemo do točk iz faznega prostora $\x_j, j = 1, \ldots, M$ porazdeljenih po
    verjetnostni gostoti $w(\x)$ - pričakovane vrednosti opazljivk tedaj dobimo kot:

    \begin{equation}\label{eq1}
        \expected{a} = \int d^N\x w(\x) a(\x) = \lim_{M \to \infty} \frac{1}{M} \sum_{j=1}^M a(\x_j)
    \end{equation}

    \section{2D Isingov model}

    Vzemimo kvadratno mrežo klasičnih Isingovih spinov:

    \begin{equation}\label{eq2}
        \s_r \in \{ -1, 1 \}, \quad r \in L \subset \mathbb{Z}^2
    \end{equation}

    Energijo take mreže v konfiguraciji spinov $\us$ in magnetnem polju $h$ zapišemo kot:

    \begin{equation}\label{eq3}
        E(\us) = \sum_{<r, r'>} \s_r \s_{r'} - h\sum_r \s_r
    \end{equation}

    Vzamemo še, da so točke v falznem prostoru porazdeljene po Boltzmanovi porazdelitvi:

    \begin{equation}\label{eq4}
        w(\us) = Z^{-1}\exp(-\beta E(\us))
    \end{equation}

    Želimo simulirati obnašanje pričakovanih vrednosti magnetne susceptibilnosti $\chi$ ter toplotne kapacitete $C_V$
    od temperature $T = \frac{1}{\beta}$.
    Ti se izražata kar preko fluktuacij magnetizacije in energije:

    \begin{equation}\label{eq5}
        \chi = \beta (\expected{M^2} - \expected{M}^2), \quad C_V = \beta^2(\expected{E^2} - \expected{E}^2)
    \end{equation}

    Potek simulacije je naslednji: Izberemo si primerno začetno stanje (osnovno, če začnemo pri
    zelo nizki temperaturi oziroma naključno, če začnemo pri zelo visoki), nato se z Metropolisovim algoritmom
    sprehajamo po faznem prostoru in na vsakih nekaj korakov izračunamo opazljivki $M$ in $E$.
    Po končanem sprehodu izračunamo fluktuaciji in tako določimo vrednosti $\chi$ in $C_V$.
    Ta postopek ponavljamo pri različnih vrednostih inverzne temperature $\beta$. \\

    Natančna izvedba Metropolisovega sprehoda je naslednja:

    \begin{enumerate}
        \item Naključno si izberemo mesto $r$ na mreži, kjer bomo poskusili obrniti spin.

        \item Izračunamo razliko v energiji, če bi spin obrnili:
        \begin{equation}\label{eq6}
        \D E_r = 2\s_r \left( \sum_{r'}^{<r, r'>} \s_{r'} + h \right)
        \end{equation}

        \item Če $\D E_r < 0$, spin obrnemo, sicer izberemo enakomerno porazdeljen $\xi \in [0, 1]$ in spin obrnemo če:
        \begin{equation}\label{eq7}
            \xi < \exp(-\beta \D E_r)
        \end{equation}

        \item Če smo spin obrnili, posodobimo vrednosti $M$ in $E$ v sistemu.

    \end{enumerate}

    \iffalse
    \begin{figure}
        \centering
        \includegraphics[width = \textwidth]{slika16.pdf}
        \caption{Odvisnost toka $J$ med termostatom in verigo v odvisnosti od časa vzorčenja $\tau$.
        Računano je na anharmonski ($\lambda = 1$) verigi dolžine $N = 10$ in povprečeno po $1000$ vzorcih.
        $J_1$ se nanaša na tok na levi, $J_2$ pa na desni strani verige.}
        \label{slika6}
    \end{figure}
    \fi

\end{document}
